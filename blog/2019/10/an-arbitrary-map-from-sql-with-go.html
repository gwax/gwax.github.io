<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>An Arbitrary map from SQL with Go | gwax</title>
<link rel="stylesheet" href="/assets/css/baguetteBox.min.css" type="text/css">
<link rel="stylesheet" href="/assets/css/normalize.min.css" type="text/css">
<link rel="stylesheet" href="/assets/css/skeleton.min.css" type="text/css">
<link href="/assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="/assets/css/code.css" rel="stylesheet" type="text/css">
<link href="/assets/css/theme.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#304FE1">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="/rss.xml">
<link rel="canonical" href="https://gwax.com/blog/2019/10/an-arbitrary-map-from-sql-with-go.html">
<link rel="icon" href="/favicon.ico" sizes="32x32">
<!--[if lt IE 9]><script src="/assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="George Leslie-Waksman">
<link rel="prev" href="/blog/2017/11/grenadine.html" title="Grenadine" type="text/html">
<link rel="next" href="/blog/2019/10/uncut-jewel.html" title="Uncut Jewel" type="text/html">
<meta property="og:site_name" content="gwax">
<meta property="og:title" content="An Arbitrary map from SQL with Go">
<meta property="og:url" content="https://gwax.com/blog/2019/10/an-arbitrary-map-from-sql-with-go.html">
<meta property="og:description" content="I've been writing a lot of Go lately and finding it a pleasant balance of
simplicity, power, functionality, and ecosystem support. In a lot of cases, I
am finding the guarantees afforded by type safet">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-10-21T04:13:56Z">
<meta property="article:tag" content="code snippets">
<meta property="article:tag" content="golang">
</head>
<body>
    <div class="container">
         
    <header id="header"><div class="row">
            <div class="six columns">
                
    <h1 id="brand" class="title"><a href="/" title="gwax" rel="home">

        <span id="blog-title">gwax</span>
    </a></h1>

            </div>
            

        </div>
    </header><nav class="bar"><li><a href="/projects.html">Projects</a></li>
            <li>
<span>Blog</span>
                <ul>
<li><a href="/index.html">Posts</a></li>
            <li><a href="/archive.html">Archives</a></li>
            <li><a href="/categories/index.html">Tags &amp; Categories</a></li>
            <li><a href="/rss.xml">RSS feed</a></li>

                </ul>
</li>
            <li>
<span>About</span>
                <ul>
<li><a href="/about/about-person.html">The person</a></li>
            <li><a href="/about/about-site.html">The site</a></li>

                </ul>
</li>
            <li><a href="/about/about-person.html#contact">Contact</a></li>

    

    </nav><nav class="select"><select><option value="/projects.html">Projects</option>
<optgroup label="Blog">
<option value="/index.html">Posts</option>
<option value="/archive.html">Archives</option>
<option value="/categories/index.html">Tags &amp; Categories</option>
<option value="/rss.xml">RSS feed</option>
</optgroup>
<optgroup label="About">
<option value="/about/about-person.html">The person</option>
<option value="/about/about-site.html">The site</option>
</optgroup>
<option value="/about/about-person.html#contact">Contact</option></select></nav><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html" class="u-url">An Arbitrary map from SQL with Go</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    George Leslie-Waksman
            </span></p>
            <p class="dateline">
            <a href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html" rel="bookmark">
            <time class="published dt-published" datetime="2019-10-21T04:13:56Z" itemprop="datePublished" title="2019-10-21 04:13 UTC">2019-10-21 04:13 UTC</time></a>
            </p>
            
        <p class="sourceline"><a href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I've been writing a lot of <a class="reference external" href="https://golang.org/">Go</a> lately and finding it a pleasant balance of
simplicity, power, functionality, and ecosystem support. In a lot of cases, I
am finding the guarantees afforded by type safety to be really nice but,
occasionally, the strict requirements can make some easy things much harder
than I want them to be.</p>
<p>Recently, I found myself wanting to test the behavior of some code the hit a
SQL database. Specifically, I wanted to check the results of a handful of
queries with varied columns and column types. With <a class="reference external" href="https://www.python.org/">Python</a>, I'd approach this
with <a class="reference external" href="https://www.sqlalchemy.org/">SQLAlchemy</a>, and turn the result into a <code>list</code> of <code>dict</code>s.</p>
<div class="code"><pre class="code python"><a id="rest_code_ef2633ca937c4ecb9d36f80c860a7f75-1" name="rest_code_ef2633ca937c4ecb9d36f80c860a7f75-1" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_ef2633ca937c4ecb9d36f80c860a7f75-1"></a><span class="k">def</span> <span class="nf">rows_to_dicts</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
<a id="rest_code_ef2633ca937c4ecb9d36f80c860a7f75-2" name="rest_code_ef2633ca937c4ecb9d36f80c860a7f75-2" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_ef2633ca937c4ecb9d36f80c860a7f75-2"></a>    <span class="sd">"""Covert a SQLAlchemy RowProxy into a list of dicts."""</span>
<a id="rest_code_ef2633ca937c4ecb9d36f80c860a7f75-3" name="rest_code_ef2633ca937c4ecb9d36f80c860a7f75-3" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_ef2633ca937c4ecb9d36f80c860a7f75-3"></a>    <span class="k">return</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
</pre></div>
<p>From here, it's pretty straightforward to assert the result matches
expectations. If you're using <a class="reference external" href="https://docs.pytest.org/en/latest/">pytest</a>, you'll also get really clear details on
where the results aren't what you expect. If you don't have the expected
columns or column types spot on, you're assertion will be off but you won't
hit any underlying errors at this point of your testing.</p>
<p><a class="reference external" href="https://golang.org/">Go</a>, on the other hand doesn't have quite as easy an option. The crux of the
problem is that the only way to get a result row out of a sql query is via
<a class="reference external" href="https://golang.org/pkg/database/sql/#Rows.Scan">(*Rows) Scan</a>, which
demands you know something about the structure of the result before you
query. Luckily <code>Scan</code> is happy to read anything into a <code>*string</code>
as long as you're asking for the right number of values so we can write an
equivalent function to the python list comprehension.</p>
<div class="code"><pre class="code go"><a id="rest_code_d057f4bf9dda4d3c99d719485d747345-1" name="rest_code_d057f4bf9dda4d3c99d719485d747345-1" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-1"></a><span class="kn">import</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-2" name="rest_code_d057f4bf9dda4d3c99d719485d747345-2" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-2"></a><span class="w">    </span><span class="s">"database/sql"</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-3" name="rest_code_d057f4bf9dda4d3c99d719485d747345-3" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-3"></a><span class="p">)</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-4" name="rest_code_d057f4bf9dda4d3c99d719485d747345-4" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-4"></a>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-5" name="rest_code_d057f4bf9dda4d3c99d719485d747345-5" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-5"></a><span class="kd">func</span><span class="w"> </span><span class="nx">RowsToMaps</span><span class="p">(</span><span class="nx">rows</span><span class="w"> </span><span class="o">*</span><span class="nx">sql</span><span class="p">.</span><span class="nx">Rows</span><span class="p">)</span><span class="w"> </span><span class="p">([]</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-6" name="rest_code_d057f4bf9dda4d3c99d719485d747345-6" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-6"></a><span class="w">    </span><span class="nx">columns</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">rows</span><span class="p">.</span><span class="nx">Columns</span><span class="p">()</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-7" name="rest_code_d057f4bf9dda4d3c99d719485d747345-7" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-8" name="rest_code_d057f4bf9dda4d3c99d719485d747345-8" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-9" name="rest_code_d057f4bf9dda4d3c99d719485d747345-9" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-9"></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-10" name="rest_code_d057f4bf9dda4d3c99d719485d747345-10" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-10"></a><span class="w">    </span><span class="nx">columnCount</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">columns</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-11" name="rest_code_d057f4bf9dda4d3c99d719485d747345-11" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-11"></a>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-12" name="rest_code_d057f4bf9dda4d3c99d719485d747345-12" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-12"></a><span class="w">    </span><span class="nx">cursor</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">([]</span><span class="kd">interface</span><span class="p">{},</span><span class="w"> </span><span class="nx">columnCount</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-13" name="rest_code_d057f4bf9dda4d3c99d719485d747345-13" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-13"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="nx">columnCount</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-14" name="rest_code_d057f4bf9dda4d3c99d719485d747345-14" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-14"></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">columnValue</span><span class="w"> </span><span class="kt">string</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-15" name="rest_code_d057f4bf9dda4d3c99d719485d747345-15" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-15"></a><span class="w">        </span><span class="nx">cursor</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">columnValue</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-16" name="rest_code_d057f4bf9dda4d3c99d719485d747345-16" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-16"></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-17" name="rest_code_d057f4bf9dda4d3c99d719485d747345-17" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-17"></a>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-18" name="rest_code_d057f4bf9dda4d3c99d719485d747345-18" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-18"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">resultMaps</span><span class="w"> </span><span class="p">[]</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-19" name="rest_code_d057f4bf9dda4d3c99d719485d747345-19" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-19"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">rows</span><span class="p">.</span><span class="nx">Next</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-20" name="rest_code_d057f4bf9dda4d3c99d719485d747345-20" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-20"></a><span class="w">        </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">rows</span><span class="p">.</span><span class="nx">Scan</span><span class="p">(</span><span class="nx">cursor</span><span class="o">...</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-21" name="rest_code_d057f4bf9dda4d3c99d719485d747345-21" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-21"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-22" name="rest_code_d057f4bf9dda4d3c99d719485d747345-22" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-22"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nx">resultMaps</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-23" name="rest_code_d057f4bf9dda4d3c99d719485d747345-23" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-23"></a><span class="w">        </span><span class="p">}</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-24" name="rest_code_d057f4bf9dda4d3c99d719485d747345-24" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-24"></a><span class="w">        </span><span class="nx">rowMap</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">columnCount</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-25" name="rest_code_d057f4bf9dda4d3c99d719485d747345-25" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-25"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">columnPtr</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">cursor</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-26" name="rest_code_d057f4bf9dda4d3c99d719485d747345-26" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-26"></a><span class="w">            </span><span class="nx">key</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">columns</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-27" name="rest_code_d057f4bf9dda4d3c99d719485d747345-27" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-27"></a><span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="nx">columnStr</span><span class="w"> </span><span class="kt">string</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-28" name="rest_code_d057f4bf9dda4d3c99d719485d747345-28" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-28"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nx">columnStrPtr</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">columnPtr</span><span class="p">.(</span><span class="o">*</span><span class="kt">string</span><span class="p">);</span><span class="w"> </span><span class="nx">columnStrPtr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-29" name="rest_code_d057f4bf9dda4d3c99d719485d747345-29" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-29"></a><span class="w">                </span><span class="nx">columnStr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">*</span><span class="nx">columnStrPtr</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-30" name="rest_code_d057f4bf9dda4d3c99d719485d747345-30" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-30"></a><span class="w">            </span><span class="p">}</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-31" name="rest_code_d057f4bf9dda4d3c99d719485d747345-31" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-31"></a><span class="w">            </span><span class="nx">rowMap</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">columnStr</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-32" name="rest_code_d057f4bf9dda4d3c99d719485d747345-32" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-32"></a><span class="w">        </span><span class="p">}</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-33" name="rest_code_d057f4bf9dda4d3c99d719485d747345-33" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-33"></a><span class="w">        </span><span class="nx">resultMaps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">resultMaps</span><span class="p">,</span><span class="w"> </span><span class="nx">rowMap</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-34" name="rest_code_d057f4bf9dda4d3c99d719485d747345-34" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-34"></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-35" name="rest_code_d057f4bf9dda4d3c99d719485d747345-35" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-35"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">rows</span><span class="p">.</span><span class="nx">Err</span><span class="p">();</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-36" name="rest_code_d057f4bf9dda4d3c99d719485d747345-36" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">resultMaps</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-37" name="rest_code_d057f4bf9dda4d3c99d719485d747345-37" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-37"></a><span class="w">    </span><span class="p">}</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-38" name="rest_code_d057f4bf9dda4d3c99d719485d747345-38" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-38"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">resultMaps</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="w"></span>
<a id="rest_code_d057f4bf9dda4d3c99d719485d747345-39" name="rest_code_d057f4bf9dda4d3c99d719485d747345-39" href="/blog/2019/10/an-arbitrary-map-from-sql-with-go.html#rest_code_d057f4bf9dda4d3c99d719485d747345-39"></a><span class="p">}</span><span class="w"></span>
</pre></div>
<p>This, much like the <a class="reference external" href="https://www.python.org/">Python</a> above, gives us a list of maps of column name
to column value, with the minor caveats that all values are strings and
<code>NULL</code> values become empty strings. I found it a useful chunk of code,
so I thought I'd throw it up.</p>
<p>Sure, it's more verbose but sometimes that's the price we pay for dealing
with dynamic results in a staticly typed language. There are other prices
paid in the other direction.</p>
    </div>
    <aside class="postpromonav"><nav><div itemprop="keywords" class="row tags">
            <a class="tag p-category button button-primary" href="/categories/code-snippets.html" rel="tag">code snippets</a>
            <a class="tag p-category button button-primary" href="/categories/golang.html" rel="tag">golang</a>
        </div>

    
        <div class="row pager hidden-print">
            <a class="button u-pull-left previous" href="/blog/2017/11/grenadine.html" rel="prev" title="Grenadine">Previous post</a>
            <a class="button u-pull-right next" href="/blog/2019/10/uncut-jewel.html" rel="next" title="Uncut Jewel">Next post</a>
        </div>

    </nav></aside></article></main><footer id="footer"><p>
    Contents ©2004-2022 <a href="/about/about-person.html">George Leslie-Waksman</a>
    | Source:
        <img src="/icons/github.svg" class="svg-icon"><a href="https://github.com/gwax/www-gwax">GitHub</a>
    | Powered by <a href="https://getnikola.com">Nikola</a>
    | Styled with <a href="http://getskeleton.com">Skeleton</a>
    | 
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
    <img src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" alt="Creative Commons License BY-SA" style="border:0;margin:0;"></a>

</p>
            
        </footer>
</div>
    
            <script src="/assets/js/baguetteBox.min.js"></script><script src="/assets/js/webfontloader.js"></script><script src="/assets/js/fancydates.js"></script><script src="/assets/js/theme.js"></script><!-- fancy dates --><script>
    fancydates(1);
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    WebFont.load({
        google: {
            families: ['IBM Plex Mono', 'Raleway', 'Pacifico']
        }
    });
    </script>
</body>
</html>
